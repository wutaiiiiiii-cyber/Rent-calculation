<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>社會住宅包租代管 - 租金評定系統</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root { --main-blue: #1e3a8a; --accent-blue: #3b82f6; --success-green: #10b981; --warning-red: #ef4444; }
        body { background: #f4f6f9; font-family: "Microsoft JhengHei", sans-serif; padding: 20px 0 80px; }
        .container { max-width: 950px; }
        .header-section { background: var(--main-blue); color: white; border-radius: 1rem; padding: 2rem 1.5rem; margin-bottom: 2rem; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .header-section h1 { font-weight: 800; letter-spacing: 2px; font-size: 1.8rem; }
        .calc-card { border: none; border-radius: 1.25rem; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        .card-body { padding: 2.5rem; background: white; border-radius: 1.25rem; }
        .form-label { font-weight: 700; color: #475569; margin-bottom: 0.6rem; display: flex; align-items: center; }
        .form-label::before { content: ""; display: inline-block; width: 4px; height: 16px; background: var(--accent-blue); margin-right: 8px; border-radius: 2px; }
        .form-select, .form-control { border-radius: 0.75rem; border: 1px solid #e2e8f0; padding: 0.75rem 1rem; }
        .btn-calc { background: var(--main-blue); color: white; border: none; border-radius: 0.75rem; padding: 1.1rem; font-weight: 800; font-size: 1.25rem; transition: all 0.2s; }
        .btn-calc:hover { background: #1e40af; transform: translateY(-2px); }
        .report-section { display: none; margin-top: 2.5rem; background: white; border-radius: 1.25rem; border: 2px solid #e2e8f0; animation: slideUp 0.4s ease-out; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .report-header { background: #f8fafc; padding: 1.5rem 2rem; border-bottom: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center; }
        .report-body { padding: 2.5rem 2rem; }
        .rent-result { font-size: 3.8rem; font-weight: 900; color: var(--main-blue); margin: 0.5rem 0; line-height: 1; }
        .status-badge { padding: 0.6rem 1.5rem; border-radius: 50px; font-weight: 800; font-size: 1.1rem; }
        .status-pass { background: #dcfce7; color: #15803d; }
        .status-fail { background: #fee2e2; color: #b91c1c; }
        .detail-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; background: #f8fafc; padding: 20px; border-radius: 1rem; }
        .detail-item { font-size: 0.95rem; color: #64748b; border-bottom: 1px solid #e2e8f0; padding-bottom: 8px; }
        .detail-item strong { color: #1e293b; float: right; }
    </style>
</head>
<body>

<div class="container">
    <div class="header-section text-center">
        <h1>社會住宅租金評定試算系統</h1>
        <p class="mb-0 opacity-75">正式版單價連動 · 行政區域完整覆蓋</p>
    </div>

    <div class="card calc-card">
        <div class="card-body">
            <div class="row g-4">
                <!-- 排序：北到南 -->
                <div class="col-md-4">
                    <label class="form-label">選擇縣市</label>
                    <select id="city" class="form-select form-select-lg" onchange="initDistricts()">
                        <option value="Taipei">台北市</option>
                        <option value="NewTaipei">新北市</option>
                        <option value="Taoyuan">桃園市</option>
                        <option value="Miaoli">苗栗縣</option>
                        <option value="Taichung">台中市</option>
                        <option value="Tainan">台南市</option>
                        <option value="Kaohsiung">高雄市</option>
                    </select>
                </div>
                <div class="col-md-4">
                    <label class="form-label">房型類別</label>
                    <select id="type" class="form-select form-select-lg" onchange="initDistricts()">
                        <option value="whole">整層住家 (戶)</option>
                        <option value="suite">獨立套房 (間)</option>
                    </select>
                </div>
                <div class="col-md-4">
                    <label class="form-label">行政區域</label>
                    <select id="district" class="form-select form-select-lg"></select>
                </div>

                <div class="col-md-6">
                    <label class="form-label">建物屋齡</label>
                    <select id="age" class="form-select"></select>
                </div>
                <div class="col-md-6">
                    <label class="form-label">登記坪數 (不含車位)</label>
                    <div class="input-group">
                        <input type="number" id="area" class="form-control" placeholder="輸入坪數" step="0.01">
                        <span class="input-group-text bg-white">坪</span>
                    </div>
                </div>

                <div class="col-md-4">
                    <label class="form-label">區位等級</label>
                    <select id="adjLoc" class="form-select">
                        <option value="0.05">優質區位 (+5%)</option>
                        <option value="0.03">中上區位 (+3%)</option>
                        <option value="0" selected>一般區位 (+0%)</option>
                    </select>
                </div>
                <div class="col-md-4">
                    <label class="form-label">裝修程度</label>
                    <select id="adjDec" class="form-select">
                        <option value="0.05">中等裝修 (+5%)</option>
                        <option value="0.03">簡易裝修 (+3%)</option>
                        <option value="0" selected>無裝修/現況 (+0%)</option>
                    </select>
                </div>
                <div class="col-md-4">
                    <label class="form-label">附贈設備加價</label>
                    <div class="input-group">
                        <span class="input-group-text">$</span>
                        <input type="number" id="equip" class="form-control" placeholder="上限2k/1k">
                    </div>
                </div>

                <div class="col-12 mt-4">
                    <button class="btn btn-calc w-100 shadow-sm" onclick="calculate()">
                        產出評定試算報告
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="reportSection" class="report-section shadow-lg">
        <div class="report-header">
            <span class="fw-bold text-muted">REPORT: EVAL-2026</span>
            <span id="statusBadge" class="status-badge">符合標準</span>
        </div>
        <div class="report-body">
            <div class="row align-items-center">
                <div class="col-md-6 text-center text-md-start">
                    <div class="text-muted fw-bold small">建議租金評定上限 (月租)：</div>
                    <div class="rent-result">NT$ <span id="resPrice">0</span></div>
                    <div id="limitNotice" class="mt-2 fw-bold"></div>
                </div>
                <div class="col-md-6">
                    <div class="detail-grid">
                        <div class="detail-item">評定行政區：<strong id="resRegion">-</strong></div>
                        <div class="detail-item">基礎單價：<strong id="resBase">-</strong> 元/坪</div>
                        <div class="detail-item">加成比例：<strong id="resAdj">-</strong> %</div>
                        <div class="detail-item">建物坪數：<strong id="resArea">-</strong> 坪</div>
                        <div class="detail-item" style="grid-column: span 2;">縣市收件上限：<strong id="resLimit">-</strong></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// 【核心資料庫】全台所有行政區數據
const DB = {
    Taipei: { name: "台北市", cap: { whole: 39000, suite: 24000 }, ages: ["0-5","5-10","10-15","15-20","20-25","25-30","30-40","40+"],
        whole: {
            "大安區": [1725,1715,1695,1670,1640,1605,1575,1500], "中山區": [1725,1715,1695,1670,1640,1605,1575,1500],
            "中正區": [1705,1690,1675,1645,1615,1585,1555,1480], "信義區": [1705,1690,1675,1645,1615,1585,1555,1480],
            "大同區": [1680,1665,1650,1625,1595,1565,1535,1460], "松山區": [1680,1665,1650,1625,1595,1565,1535,1460],
            "南港區": [1545,1530,1515,1490,1465,1435,1410,1340], "萬華區": [1545,1530,1515,1490,1465,1435,1410,1340],
            "士林區": [1495,1485,1470,1445,1420,1395,1365,1300], "內湖區": [1495,1485,1470,1445,1420,1395,1365,1300],
            "文山區": [1415,1405,1390,1370,1345,1320,1295,1230], "北投區": [1415,1405,1390,1370,1345,1320,1295,1230]
        },
        suite: {
            "大安區": [2475,2435,2390,2350,2290,2225,2165,2060], "中山區": [2365,2325,2290,2250,2190,2130,2070,1970],
            "松山區": [2305,2270,2230,2190,2135,2075,2020,1920], "信義區": [2220,2185,2150,2110,2055,2000,1945,1850],
            "中正區": [2175,2140,2100,2065,2010,1955,1905,1810], "大同區": [2160,2125,2090,2055,2000,1945,1890,1800],
            "南港區": [2160,2125,2090,2055,2000,1945,1890,1800], "萬華區": [2160,2125,2090,2055,2000,1945,1890,1800],
            "士林區": [2040,2010,1975,1940,1890,1840,1785,1700], "內湖區": [2040,2010,1975,1940,1890,1840,1785,1700],
            "文山區": [1920,1890,1860,1825,1780,1730,1680,1600], "北投區": [1920,1890,1860,1825,1780,1730,1680,1600]
        }
    },
    NewTaipei: { name: "新北市", cap: { whole: 35000, suite: 21000 }, ages: ["0-5","5-10","10-15","15-20","20-25","25-30","30-40","40+"],
        whole: {
            "三重區": [1380,1370,1360,1335,1310,1285,1260,1200], "永和區": [1210,1200,1190,1170,1145,1125,1105,1050],
            "板橋區": [1185,1175,1165,1145,1125,1105,1085,1030], "中和區": [1165,1155,1145,1125,1105,1085,1065,1010],
            "新店區": [1060,1050,1040,1025,1005,985,970,920], "新莊區": [1050,1040,1030,1015,995,975,960,910],
            "蘆洲區": [1050,1040,1030,1015,995,975,960,910], "土城區": [1015,1005,995,980,960,945,925,880],
            "汐止區": [980,970,965,945,930,910,895,850], "林口區": [920,915,905,890,875,860,840,800],
            "泰山區": [920,915,905,890,875,860,840,800], "五股區": [890,880,875,855,840,825,810,770],
            "樹林區": [890,880,875,855,840,825,810,770], "三峽區": [795,790,780,770,755,740,725,690],
            "鶯歌區": [750,745,735,725,710,700,685,650], "淡水區": [715,710,705,690,680,665,655,620],
            "八里區": [645,640,635,625,615,600,590,560], "深坑區": [635,630,625,615,600,590,580,550],
            "金山區": [460,460,455,445,440,430,420,400], "其他區": [360,355,355,345,340,335,330,310]
        },
        suite: {
            "三重區": [1815,1785,1755,1725,1680,1635,1590,1510], "永和區": [1790,1760,1730,1700,1655,1610,1565,1490],
            "板橋區": [1780,1750,1720,1690,1645,1600,1555,1480], "中和區": [1670,1645,1615,1585,1545,1505,1460,1390],
            "新店區": [1670,1645,1615,1585,1545,1505,1460,1390], "土城區": [1600,1570,1545,1520,1480,1440,1400,1330],
            "新莊區": [1600,1570,1545,1520,1480,1440,1400,1330], "汐止區": [1405,1385,1360,1335,1300,1265,1230,1170],
            "蘆洲區": [1405,1385,1360,1335,1300,1265,1230,1170], "林口區": [1320,1300,1280,1255,1225,1190,1155,1100],
            "泰山區": [1320,1300,1280,1255,1225,1190,1155,1100], "其他區": [385,380,375,365,360,350,340,320]
        }
    },
    Taoyuan: { name: "桃園市", cap: { whole: 35000, suite: 21000 }, ages: ["0-5","5-10","10-15","15-20","20-25","25-30","30-35","35-40","40+"],
        whole: {
            "龜山區": [855,840,825,805,785,760,740,710,675], "桃園區": [780,770,755,735,720,700,680,650,620],
            "中壢區": [770,760,745,725,705,685,670,640,610], "蘆竹區": [745,735,720,705,685,665,645,620,590],
            "八德區": [735,720,710,690,675,655,635,610,580], "大園區": [735,720,710,690,675,655,635,610,580],
            "平鎮區": [720,710,700,680,660,645,625,600,570], "觀音區": [700,685,675,660,640,625,605,580,555],
            "楊梅區": [615,605,595,580,565,550,535,510,485], "新屋區": [580,570,560,545,530,515,500,480,460],
            "龍潭區": [580,570,560,545,530,515,500,480,460], "大溪區": [565,555,550,535,520,505,490,470,450], "復興區": [375,370,360,355,345,335,325,310,295]
        },
        suite: {
            "龜山區": [1225,1205,1185,1155,1125,1095,1065,1020,970], "蘆竹區": [1180,1160,1140,1110,1080,1050,1020,980,935],
            "桃園區": [1120,1100,1080,1055,1025,1000,970,930,885], "中壢區": [1080,1065,1045,1020,995,965,940,900,855],
            "八德區": [1045,1030,1010,985,960,935,905,870,830], "大園區": [1045,1030,1010,985,960,935,905,870,830],
            "平鎮區": [900,885,870,850,830,805,780,750,715], "觀音區": [900,885,870,850,830,805,780,750,715],
            "楊梅區": [830,815,805,780,760,740,720,690,660], "龍潭區": [830,815,805,780,760,740,720,690,660],
            "大溪區": [710,700,685,670,650,635,615,590,565], "新屋區": [625,615,605,590,575,560,545,520,495], "復興區": [385,380,375,365,355,345,335,320,305]
        }
    },
    Miaoli: { name: "苗栗縣", cap: { whole: 22000, suite: 14000 }, ages: ["0-5","5-10","10-15","15-20","20-25","25-30","30-35","35-40","40+"],
        whole: {
            "竹南鎮": [600,590,580,565,550,535,520,500,475], "頭份市": [580,570,560,545,530,515,500,480,460], "苗栗市": [530,520,515,500,485,475,460,440,420],
            "後龍鎮": [495,485,480,465,455,440,430,410,390], "苑裡鎮": [435,425,420,410,400,390,375,360,345], "公館鄉": [420,415,410,400,390,375,365,350,335],
            "銅鑼鄉": [420,415,410,400,390,375,365,350,335], "大湖鄉": [385,380,375,365,355,345,335,320,305], "其他": [375,370,360,355,345,335,325,310,295]
        },
        suite: {
            "竹南鎮": [805,795,780,760,740,720,700,670,640], "頭份市": [805,795,780,760,740,720,700,670,640], "苗栗市": [660,650,640,625,605,590,575,550,525],
            "後龍鎮": [505,500,490,475,465,450,440,420,400], "公館/苑裡": [470,465,455,445,430,420,410,390,375], "其他": [385,380,375,365,355,345,335,320,305]
        }
    },
    Taichung: { name: "台中市", cap: { whole: 35000, suite: 21000 }, ages: ["0-5","5-10","10-15","15-20","20-25","25-30","30-35","35-40","40+"],
        whole: {
            "西屯區": [940,925,905,885,860,835,815,780,745], "北屯區": [900,885,870,850,830,805,780,750,715],
            "南屯區": [900,885,870,850,830,805,780,750,715], "北區": [890,875,860,840,815,795,770,740,705],
            "西區": [890,875,860,840,815,795,770,740,705], "中區": [830,815,805,780,760,740,720,690,660],
            "東區": [830,815,805,780,760,740,720,690,660], "南區": [780,770,755,735,720,700,680,650,620],
            "大里區": [770,760,745,725,705,685,670,640,610], "太平區": [770,760,745,725,705,685,670,640,610],
            "潭子區": [770,760,745,725,705,685,670,640,610], "豐原區": [770,760,745,725,705,685,670,640,610], "其他": [375,370,360,355,345,335,325,310,295]
        },
        suite: {
            "西屯區": [1120,1100,1080,1055,1025,1000,970,930,885], "北屯區": [1060,1040,1025,995,970,945,920,880,840],
            "南屯區": [1060,1040,1025,995,970,945,920,880,840], "北區": [1045,1030,1010,985,960,935,905,870,830],
            "西區": [1045,1030,1010,985,960,935,905,870,830], "南區": [985,970,955,930,905,880,855,820,780],
            "烏日/大里": [890,875,860,840,815,795,770,740,705], "其他": [385,380,375,365,355,345,335,320,305]
        }
    },
    Tainan: { name: "台南市", cap: { whole: 29000, suite: 18000 }, ages: ["0-5","5-10","10-15","15-20","20-25","25-30","30-35","35-40","40+"],
        whole: {
            "中西區": [820,805,790,770,750,730,710,680,650], "北區": [820,805,790,770,750,730,710,680,650],
            "永康區": [820,805,790,770,750,730,710,680,650], "東區": [770,760,745,725,705,685,670,640,610],
            "安平區": [745,735,720,705,685,665,645,620,590], "安南區": [720,710,700,680,660,645,625,600,570],
            "善化區": [685,675,665,645,630,610,595,570,545], "新營區": [495,485,480,465,455,440,430,410,390], "其他": [375,370,360,355,345,335,325,310,295]
        },
        suite: {
            "北區": [1035,1015,1000,975,950,925,895,860,820], "東區": [1035,1015,1000,975,950,925,895,860,820],
            "安平區": [1020,1005,990,965,940,910,885,850,810], "中西區": [960,945,930,905,885,860,835,800,760],
            "永康區": [960,945,930,905,885,860,835,800,760], "仁德區": [940,925,905,885,860,835,815,780,745], "其他": [385,380,375,365,355,345,335,320,305]
        }
    },
    Kaohsiung: { name: "高雄市", cap: { whole: 29000, suite: 18000 }, ages: ["0-5","5-10","10-15","15-20","20-25","25-30","30-35","35-40","40+"],
        whole: {
            "前金區": [820,805,790,770,750,730,710,680,650], "三民區": [795,780,770,750,730,710,690,660,630],
            "新興區": [795,780,770,750,730,710,690,660,630], "苓雅區": [795,780,770,750,730,710,690,660,630],
            "前鎮區": [735,720,710,690,675,655,635,610,580], "左營區": [735,720,710,690,675,655,635,610,580],
            "鼓山區": [735,720,710,690,675,655,635,610,580], "鳳山區": [675,665,650,635,620,600,585,560,535], "其他": [375,370,360,355,345,335,325,310,295]
        },
        suite: {
            "鼓山區": [1140,1125,1105,1075,1045,1020,990,950,905], "前金區": [1120,1100,1080,1055,1025,1000,970,930,885],
            "新興區": [1120,1100,1080,1055,1025,1000,970,930,885], "三民區": [1095,1075,1060,1030,1005,975,950,910,865],
            "左營區": [960,945,930,905,885,860,835,800,760], "楠梓/鳳山": [950,935,920,895,870,850,825,790,755], "其他": [385,380,375,365,355,345,335,320,305]
        }
    }
};

function initDistricts() {
    const city = document.getElementById('city').value;
    const type = document.getElementById('type').value;
    const distSelect = document.getElementById('district');
    const ageSelect = document.getElementById('age');
    distSelect.innerHTML = "";
    const list = DB[city][type];
    Object.keys(list).forEach(d => distSelect.add(new Option(d, d)));
    ageSelect.innerHTML = "";
    DB[city].ages.forEach((a, idx) => ageSelect.add(new Option(a + " 年", idx)));
}

function calculate() {
    const city = document.getElementById('city').value;
    const type = document.getElementById('type').value;
    const dist = document.getElementById('district').value;
    const ageIdx = parseInt(document.getElementById('age').value);
    const area = parseFloat(document.getElementById('area').value);
    const equip = parseFloat(document.getElementById('equip').value) || 0;
    const locAdj = parseFloat(document.getElementById('adjLoc').value);
    const decAdj = parseFloat(document.getElementById('adjDec').value);

    if (!area || area <= 0) { alert("請輸入正確登記坪數"); return; }
    
    const unitPrices = DB[city][type][dist];
    const basePrice = unitPrices[Math.min(ageIdx, unitPrices.length - 1)];
    let rent = Math.round((area * basePrice * (1 + locAdj + decAdj)) + equip);

    const cap = DB[city].cap[type];
    const report = document.getElementById('reportSection');
    const badge = document.getElementById('statusBadge');
    
    report.style.display = 'block';
    document.getElementById('resPrice').innerText = rent.toLocaleString();
    document.getElementById('resRegion').innerText = `${DB[city].name}${dist}`;
    document.getElementById('resBase').innerText = basePrice;
    document.getElementById('resAdj').innerText = `+${Math.round((locAdj+decAdj)*100)}`;
    document.getElementById('resArea').innerText = area;
    document.getElementById('resLimit').innerText = `$${cap.toLocaleString()}`;

    if (rent > cap) {
        report.className = "report-section fail shadow-lg";
        badge.innerText = "⚠️ 超過上限"; badge.className = "status-badge status-fail";
        document.getElementById('limitNotice').className = "mt-2 text-danger fw-bold";
        document.getElementById('limitNotice').innerText = "本件評定結果超過縣市限額，請調整租金或條件。";
    } else {
        report.className = "report-section pass shadow-lg";
        badge.innerText = "✅ 符合標準"; badge.className = "status-badge status-pass";
        document.getElementById('limitNotice').className = "mt-2 text-success fw-bold";
        document.getElementById('limitNotice').innerText = "試算結果符合政策限額，具備計畫加入資格。";
    }
    window.scrollTo({ top: report.offsetTop - 50, behavior: 'smooth' });
}
window.onload = initDistricts;
</script>

</body>
</html>